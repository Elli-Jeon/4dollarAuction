<!DOCTYPE html>
<html>
    <head>
        <title>Socket.IO chat</title>
        <link rel="icon" type="image/x-icon" href="/assets/images/icons/favicon.ico">
	
	
        <script type="text/javascript">
            WebFontConfig = {
                google: { families: [ 'Open+Sans:300,400,600,700,800','Poppins:300,400,500,600,700', 'Shadows+Into+Light:400' ] }
            };
            (function(d) {
                var wf = d.createElement('script'), s = d.scripts[0];
                wf.src = '/assets/js/webfont.js';
                wf.async = true;
                s.parentNode.insertBefore(wf, s);
            })(document);
        </script>
        
        <!-- Plugins CSS File -->
        <link rel="stylesheet" href="/assets/css/bootstrap.min.css">

        <!-- Main CSS File -->
        <link rel="stylesheet" href="/assets/css/style.min.css">
        <link rel="stylesheet" type="text/css" href="/assets/vendor/fontawesome-free/css/all.min.css">
        <link rel="stylesheet" href="/style.css">
    </head>
    <body class="loaded">
        <div class="page-wrapper">
            <header class="header">
                <div class="header-middle text-dark">
                    <div class="container">
                        <div class="header-left col-lg-2 w-auto pl-0">
                            <button class="mobile-menu-toggler mr-2" type="button">
                                <i class="icon-menu"></i>
                            </button>
                            <a href="index.html" class="logo">
                                <img src="assets/images/logo-4dollar-removebg.png" alt="4dollar Logo" width="140px" height="140px">
                            </a>
                        </div><!-- End .header-left -->
    
                        <div class="header-right w-lg-max pl-2">
                            <div class="header-search header-icon header-search-inline header-search-category w-lg-max mr-lg-4">
                                <a href="#" class="search-toggle" role="button"><i class="icon-search-3"></i></a>
                                <form action="#" method="get">
                                    <div class="header-search-wrapper">
                                        <input type="search" class="form-control" name="q" id="q" placeholder="Search..." required>
                                        <div class="select-custom">
                                            <select id="cat" name="cat">
                                                <option value="">All Categories</option>
                                                <option value="4">Fashion</option>
                                                <option value="12">- Women</option>
                                                <option value="13">- Men</option>
                                                <option value="66">- Jewellery</option>
                                                <option value="67">- Kids Fashion</option>
                                                <option value="5">Electronics</option>
                                                <option value="21">- Smart TVs</option>
                                                <option value="22">- Cameras</option>
                                                <option value="63">- Games</option>
                                                <option value="7">Home &amp; Garden</option>
                                                <option value="11">Motors</option>
                                                <option value="31">- Cars and Trucks</option>
                                                <option value="32">- Motorcycles &amp; Powersports</option>
                                                <option value="33">- Parts &amp; Accessories</option>
                                                <option value="34">- Boats</option>
                                                <option value="57">- Auto Tools &amp; Supplies</option>
                                            </select>
                                        </div><!-- End .select-custom -->
                                        <button class="btn p-0 icon-search-3" type="submit"></button>
                                    </div><!-- End .header-search-wrapper -->
                                </form>
                            </div><!-- End .header-search -->
    
                            <div class="header-contact d-none d-lg-flex align-items-center pr-xl-5 mr-3 ml-xl-5">
                                <i class="icon-phone-2"></i>
                                <h6 class="pt-1 line-height-1">Call us now<a href="tel:#" class="d-block text-dark ls-10 pt-1">+123 5678 890</a></h6>
                            </div><!-- End .header-contact -->
    
                            <a href="login.html" class="header-icon login-link"><i class="icon-user-2"></i></a>
    
                            <a href="#" class="header-icon"><i class="icon-wishlist-2"></i></a>
    
                            <div class="dropdown cart-dropdown">
                                <a href="#" class="dropdown-toggle dropdown-arrow" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-display="static">
                                    <i class="icon-shopping-cart"></i>
                                    <span class="cart-count badge-circle">2</span>
                                </a>
    
                                <div class="dropdown-menu">
                                    <div class="dropdownmenu-wrapper">
                                        <div class="dropdown-cart-header">
                                            <span>2 Items</span>
                                            
                                            <a href="cart.html" class="float-right">View Cart</a>
                                        </div><!-- End .dropdown-cart-header -->
                                        
                                        <div class="dropdown-cart-products">
                                            <div class="product">
                                                <div class="product-details">
                                                    <h4 class="product-title">
                                                        <a href="product.html">Woman Ring</a>
                                                    </h4>
                                                    
                                                    <span class="cart-product-info">
                                                        <span class="cart-product-qty">1</span>
                                                        x $99.00
                                                    </span>
                                                </div><!-- End .product-details -->
                                                    
                                                <figure class="product-image-container">
                                                    <a href="product.html" class="product-image">
                                                        <img src="assets/images/products/cart/product-1.jpg" alt="product" width="80" height="80">
                                                    </a>
                                                    <a href="#" class="btn-remove icon-cancel" title="Remove Product"></a>
                                                </figure>
                                            </div><!-- End .product -->
                                            
                                            <div class="product">
                                                <div class="product-details">
                                                    <h4 class="product-title">
                                                        <a href="product.html">Woman Necklace</a>
                                                    </h4>
                                                    
                                                    <span class="cart-product-info">
                                                        <span class="cart-product-qty">1</span>
                                                        x $35.00
                                                    </span>
                                                </div><!-- End .product-details -->
                                                
                                                <figure class="product-image-container">
                                                    <a href="product.html" class="product-image">
                                                        <img src="assets/images/products/cart/product-2.jpg" alt="product" width="80" height="80">
                                                    </a>
                                                    <a href="#" class="btn-remove icon-cancel" title="Remove Product"></a>
                                                </figure>
                                            </div><!-- End .product -->
                                        </div><!-- End .cart-product -->
                                        
                                        <div class="dropdown-cart-total">
                                            <span>Total</span>
                                            
                                            <span class="cart-total-price float-right">$134.00</span>
                                        </div><!-- End .dropdown-cart-total -->
                                        
                                        <div class="dropdown-cart-action">
                                            <a href="checkout-shipping.html" class="btn btn-dark btn-block">Checkout</a>
                                        </div><!-- End .dropdown-cart-total -->
                                    </div><!-- End .dropdownmenu-wrapper -->
                                </div><!-- End .dropdown-menu -->
                            </div><!-- End .dropdown -->
                        </div><!-- End .header-right -->
                    </div><!-- End .container -->
                </div><!-- End .header-middle -->

                <div class="header-bottom sticky-header d-none d-lg-block">
                    <div class="container">
                        <nav class="main-nav w-100">
                            <ul class="menu">
                                <li>
                                    <a href="index.html">Home</a>
                                </li>
                                <li class="active">
                                    <a href="category.html">Categories</a>
                                    <div class="megamenu megamenu-fixed-width megamenu-3cols">
                                        <div class="row">
                                            <div class="col-lg-4">
                                                <a href="#" class="nolink">VARIATION 1</a>
                                                <ul class="submenu">
                                                    <li><a href="category.html">Fullwidth Banner</a></li>
                                                    <li><a href="category-banner-boxed-slider.html">Boxed Slider Banner</a></li>
                                                    <li><a href="category-banner-boxed-image.html">Boxed Image Banner</a></li>
                                                    <li><a href="category.html">Left Sidebar</a></li>
                                                    <li><a href="category-sidebar-right.html">Right Sidebar</a></li>
                                                    <li><a href="category-flex-grid.html">Product Flex Grid</a></li>
                                                    <li><a href="category-horizontal-filter1.html">Horizontal Filter1</a></li>
                                                    <li><a href="category-horizontal-filter2.html">Horizontal Filter2</a></li>
                                                </ul>
                                            </div>
                                            <div class="col-lg-4">
                                                <a href="#" class="nolink">VARIATION 2</a>
                                                <ul class="submenu">
                                                    <li><a href="category-list.html">Product List Item Types</a></li>
                                                    <li><a href="category-infinite-scroll.html">Ajax Infinite Scroll</a></li>
                                                    <li><a href="category.html">3 Columns Products</a></li>
                                                    <li><a href="category-4col.html">4 Columns Products</a></li>
                                                    <li><a href="category-5col.html">5 Columns Products</a></li>
                                                    <li><a href="category-6col.html">6 Columns Products</a></li>
                                                    <li><a href="category-7col.html">7 Columns Products</a></li>
                                                    <li><a href="category-8col.html">8 Columns Products</a></li>
                                                </ul>
                                            </div>
                                            <div class="col-lg-4 p-0">
                                                <img src="assets/images/menu-banner.jpg" alt="Menu banner">
                                            </div>
                                        </div>
                                    </div><!-- End .megamenu -->
                                </li>
                                <li>
                                    <a href="product.html">Products</a>
                                    <div class="megamenu megamenu-fixed-width">
                                        <div class="row">
                                            <div class="col-lg-3">
                                                <a href="#" class="nolink">Variations 1</a>
                                                <ul class="submenu">
                                                    <li><a href="product.html">Horizontal Thumbnails</a></li>
                                                    <li><a href="product-full-width.html">Vertical Thumbnails</a></li>
                                                    <li><a href="product.html">Inner Zoom</a></li>
                                                    <li><a href="product-addcart-sticky.html">Addtocart Sticky</a></li>
                                                    <li><a href="product-sidebar-left.html">Accordion Tabs</a></li>
                                                </ul>
                                            </div><!-- End .col-lg-4 -->
                                            <div class="col-lg-3">
                                                <a href="#" class="nolink">Variations 2</a>
                                                <ul class="submenu">
                                                    <li><a href="product-sticky-tab.html">Sticky Tabs</a></li>
                                                    <li><a href="product-simple.html">Simple Product</a></li>
                                                    <li><a href="product-sidebar-left.html">With Left Sidebar</a></li>
                                                </ul>
                                            </div><!-- End .col-lg-4 -->
                                            <div class="col-lg-3">
                                                <a href="#" class="nolink">Product Layout Types</a>
                                                <ul class="submenu">
                                                    <li><a href="product.html">Default Layout</a></li>
                                                    <li><a href="product-extended-layout.html">Extended Layout</a></li>
                                                    <li><a href="product-full-width.html">Full Width Layout</a></li>
                                                    <li><a href="product-grid-layout.html">Grid Images Layout</a></li>
                                                    <li><a href="product-sticky-both.html">Sticky Both Side Info</a></li>
                                                    <li><a href="product-sticky-info.html">Sticky Right Side Info</a></li>
                                                </ul>
                                            </div><!-- End .col-lg-4 -->
    
                                            <div class="col-lg-3 p-0">
                                                <img src="assets/images/menu-bg.png" alt="Menu banner" class="product-promo">
                                            </div><!-- End .col-lg-4 -->
                                        </div><!-- End .row -->
                                    </div><!-- End .megamenu -->
                                </li>
                                <li>
                                    <a href="#">Pages</a>
                                    <ul>
                                        <li><a href="cart.html">Shopping Cart</a></li>
                                        <li><a href="#">Checkout</a>
                                            <ul>
                                                <li><a href="checkout-shipping.html">Checkout Shipping</a></li>
                                                <li><a href="checkout-shipping-2.html">Checkout Shipping 2</a></li>
                                                <li><a href="checkout-review.html">Checkout Review</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#">Dashboard</a>
                                            <ul>
                                                <li><a href="dashboard.html">Dashboard</a></li>
                                                <li><a href="my-account.html">My Account</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="about.html">About Us</a></li>
                                        <li><a href="#">Blog</a>
                                            <ul>
                                                <li><a href="blog.html">Blog</a></li>
                                                <li><a href="single.html">Blog Post</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="contact.html">Contact Us</a></li>
                                        <li><a href="#" class="login-link">Login</a></li>
                                        <li><a href="forgot-password.html">Forgot Password</a></li>
                                    </ul>
                                </li>
                                <li><a href="blog.html">Blog</a></li>
                                <li><a href="about.html">About Us</a></li>
                                <li><a href="contact.html">Contact Us</a></li>
                                <li class="float-right"><a href="https://1.envato.market/DdLk5" target="_blank">Buy Porto!<span class="tip tip-new tip-top">New</span></a></li>
                                <li class="float-right"><a href="#">Special Offer!</a></li>
                            </ul>
                        </nav>
                    </div><!-- End .container -->
                </div><!-- End .header-bottom -->
            </header>

            <main class="main">
                <div class="container">

                    <div class="row">
                        <div class="col-lg-6 order-lg-1">

                            <nav class="toolbox">
                                <div class="toolbox-left">
                                    <div class="toolbox-item toolbox-sort">
                                        <label>Room Name : </label>
                                        
                                        <div class="roomname">
                                            Selling Bag from only 30$!!!
                                        </div><!-- End .roomname -->   
                                        
                                    </div><!-- End .toolbox-item -->
                                </div><!-- End .toolbox-left -->
    
                                <div class="toolbox-right">
                                    <div class="timebox">
                                        <div class="starttime">
                                            <span>Start at :</span>
                                            <span id="starttime">0</span>
                                        </div> <!--End. starttime -->
                                        <div class="endtime">
                                            <span>End at :</span>
                                            <span id="endtime">0</span>
                                        </div> <!--End. endtime -->
                                    </div> <!--End .timebox-->     

                                    <div class="timer">
                                        <span id="realtimer"></span>  
                                    </div> <!-- 여기에 타이머 넣어야.-->
                                </div><!-- End .toolbox-right -->
                            </nav>
                            
                            <script src="/timer.js"></script>

                            <div class="chatroom">        
                                <ul id="messages"></ul>
                                <form id="form" action="">
                                <input id="input" autocomplete="off" type="number" min="1000" step="100"/>
                                <button type="reset">reset</button>
                                <button>Send</button>
                                </form>
                            </div>
                        </div><!-- End .col-lg-6 -->
                        
                        <div class="col-lg-3 order-lg-1">
                            <div class="product-explain__section">
                                <h3>Product Information</h3>
                            </div>
                            <div class="col-12 product-default left-details product-list mb-4 product-explain">
                                <figure>
                                    <a href="product.html">
                                        <img src="assets/images/products/product-1.jpg">
                                    </a>
                                </figure>
                                <div class="product-explain__description">
                                    <div class="category-list">
                                        <a href="category.html" class="product-category">category</a>
                                    </div>
                                    <h2 class="product-title">
                                        <a href="product.html">Product Short Name</a>
                                    </h2>
                                    <div class="ratings-container">
                                        <div class="product-ratings">
                                            <span class="ratings" style="width:100%"></span><!-- End .ratings -->
                                            <span class="tooltiptext tooltip-top"></span>
                                        </div><!-- End .product-ratings -->
                                    </div><!-- End .product-container -->
                                    <p class="product-description">Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vestibulum tortor quam, feugiat vitae, ultricies eget, tempor sit amet, ante. Donec eu libero sit amet quam egestas semper. Aenean ultricies mi vitae est. Mauris placerat eleifend leo.</p>
                                    <div class="price-box">
                                        <span class="product-price">Start Price</span>
                                        <span class="product-price">$15.00</span>
                                    </div><!-- End .price-box -->
                                </div><!-- End .product-details -->
                            </div>
                            <div>
                                <h3>HIGHEST PRICE NOW!</h3>
                                <div class="highestprice">
                                    <h3 class="Highest"></h3>
                                    <!-- 최고가는 여기에 추가 됨 -->
                                </div>
                            </div>
                        </div><!-- End .col-lg-3 -->


                        <aside class="sidebar-shop col-lg-3 mobile-sidebar">
                            <div class="sidebar-wrapper">
                                <div class="widget">
                                    <h3 class="widget-title">
                                        <a data-toggle="collapse" href="#widget-body-2" role="button" aria-expanded="true" aria-controls="widget-body-2">Room #1</a>
                                    </h3>
    
                                    <div class="collapse show" id="widget-body-2">
                                        <div class="widget-body">
                                            <div class="otherroom">
                                                <a href="/room1.html"><img src="/assets/images/brands/brand4.png" width="100" height="100" alt="image"></a>
                                                <a href="/room1.html"><h4>Anyone wants to buy GUCCI bag?</h4></a>
                                            </div>
                                            <div class="otherroomexplain">
                                                <span>Number of Participant : </span>
                                                <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Molestiae minima eveniet quibusdam libero
                                                </p>
                                            </div>
                                        </div><!-- End .widget-body -->
                                    </div><!-- End .collapse -->
                                </div><!-- End .widget -->
                                <div class="widget">
                                    <h3 class="widget-title">
                                        <a data-toggle="collapse" href="#widget-body-2" role="button" aria-expanded="true" aria-controls="widget-body-2">Room #2</a>
                                    </h3>
    
                                    <div class="collapse show" id="widget-body-2">
                                        <div class="widget-body">
                                            <div class="otherroom">
                                                <a href="/room1.html"><img src="/assets/images/brands/brand3.png" width="60" height="60" alt="image"></a>
                                                <a href="/room1.html"><h4>POKEMON card Limited edition</h4></a>
                                            </div>
                                            <div class="otherroomexplain">
                                                <span>Number of Participant : </span>
                                                <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Molestiae minima eveniet quibusdam libero
                                                </p>
                                            </div>
                                        </div><!-- End .widget-body -->
                                    </div><!-- End .collapse -->
                                </div><!-- End .widget -->
                                <div class="widget">
                                    <h3 class="widget-title">
                                        <a data-toggle="collapse" href="#widget-body-2" role="button" aria-expanded="true" aria-controls="widget-body-2">Room #3</a>
                                    </h3>
    
                                    <div class="collapse show" id="widget-body-2">
                                        <div class="widget-body">
                                            <div class="otherroom">
                                                <a href="/room1.html"><img src="/assets/images/brands/brand4.png" width="60" height="60" alt="image"></a>
                                                <a href="/room1.html"><h4>Luxury Shoes</h4></a>
                                            </div>
                                            <div class="otherroomexplain">
                                                <span>Number of Participant : </span>
                                                <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Molestiae minima eveniet quibusdam libero
                                                </p>
                                            </div>
                                        </div><!-- End .widget-body -->
                                    </div><!-- End .collapse -->
                                </div><!-- End .widget -->
                                <div class="widget">
                                    <h3 class="widget-title">
                                        <a data-toggle="collapse" href="#widget-body-2" role="button" aria-expanded="true" aria-controls="widget-body-2">Room #4</a>
                                    </h3>
    
                                    <div class="collapse show" id="widget-body-2">
                                        <div class="widget-body">
                                            <div class="otherroom">
                                                <a href="/room1.html"><img src="/assets/images/brands/brand2.png" width="60" height="60" alt="image"></a>
                                                <a href="/room1.html"><h4>Here's your new jacket</h4></a>
                                            </div>
                                            <div class="otherroomexplain">
                                                <span>Number of Participant : </span>
                                                <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Molestiae minima eveniet quibusdam libero
                                                </p>
                                            </div>
                                        </div><!-- End .widget-body -->
                                    </div><!-- End .collapse -->
                                </div><!-- End .widget -->
 
                            </div><!-- End .sidebar-wrapper -->
                        </aside><!-- End .col-lg-3 -->
                    </div><!-- End .row -->
                </div><!-- End .container -->
            </main>
        </div>
    
        <!-- 이쪽에서 서버의 socket을 받아줌 -->
        <script src="/socket.io/socket.io.js"></script>
        <script>
            let socket = io();  // client 쪽에서 socket.io여는 것. 기본적으로 host에서 여는 페이지에 연결

            let messages = document.getElementById('messages');
            let form = document.getElementById('form');
            let input = document.getElementById('input');
            
            let loginUserData = {
                token : sessionStorage.getItem('ourToken')
            };
            socket.emit('login', loginUserData); // 서버 쪽에 전달해서 서버에서 배열에 쌓아 둘 거임.

            form.addEventListener('submit', function(e){
                e.preventDefault();
                if(input.value){
                    socket.emit('chat message', input.value); 
                    // 서버쪽에 chat message라는 이름의 이벤트로 input.value 전송
                    input.value = '';
                }
            });

            socket.on('chat message', function(msg){  
                // chat message라는 같은 이름의 이벤트로 서버, 클라가 계속 대기한다. 상시 대기 상태의 루프.
                // socket.on 순서대로 작동하는 것이 아님. '이벤트'이름 보고서 작동하는 것.
                let item = document.createElement('li');
                item.textContent = msg;
                messages.appendChild(item);
                window.scrollTo(0, 0); //화면을 맨 위에 고정
                // 위는 chat에 띄어주는 작업
            });

            socket.on('highest price',(msg)=>{
                let item = document.querySelector(".Highest");
                item.textContent = msg;
                //window.scrollTo(0,3000);
                // 최고가를 화면 우측에 갱신해주는 작업.

                let msgObj = {
                    token : sessionStorage.getItem('ourToken'),
                    highestprice : msg  //최고가
                }

                socket.emit('store highest price', msgObj);
                //client session strage에 저장된 것을 가져와서 서버에 전송


            });


        </script>
    </body>
</html>